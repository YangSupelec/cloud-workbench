# VAGRANTFILE_API_VERSION = "2"  # Already initialized before
Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
  # AWS EC2 provider
  config.vm.provider :aws do |aws, override|
    # AWS instance configuration
    aws.region = "eu-west-1"
    # Official Ubuntu 14.04 LTS image for eu-west-1 from Canonical:
    #  https://cloud-images.ubuntu.com/locator/ec2/
    aws.ami = "ami-896c96fe"
    override.ssh.username = "ubuntu"
    aws.instance_type = "t1.micro"
    # Add other security groups separated by spaces.
    # Example: %w(default my_own_group)
    aws.security_groups = %w(default)
  end

  # Chef client provisioning
  config.vm.provision "chef_client", id: "chef_client" do |chef|
    # NOTE: Make sure to include the 'recipe[benchmark]'
    #       if you use chef.run_list = [...] which is NOT RECOMMENDED
    chef.add_recipe "recipe[fio-benchmark@0.2.0]"
    # NOTE: Do NOT use the ["benchmark"] attribute namespace for your own attributes
    #       It is highly recommended to use the name of the cookbook as the attribute namespace.
    chef.json =
    {
      "fio" => {
        "metric_definition_id" => "seq. write"
      }
    }
  end
end
